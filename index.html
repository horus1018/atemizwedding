<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Live Camera Upload</title>
</head>
<body>
  <h2>üì∑ Live Camera Capture & Upload</h2>
  
  <video id="video" width="300" autoplay></video>
  <br />
  <button id="captureBtn">Capture Photo</button>
  <button id="uploadBtn">Upload</button>
  <p id="status"></p>
  <br />
  <canvas id="canvas" width="300" height="225" style="display:none;"></canvas>
  <img id="preview" width="300" style="display:none;" />
  
  <script>
    const scriptURL = "YOUR_SCRIPT_URL_HERE"; // üî¥ Replace this with your Apps Script Web App URL

    // Initialize Camera
    const video = document.getElementById("video");
    navigator.mediaDevices.getUserMedia({ video: true }).then((stream) => {
      video.srcObject = stream;
    });

    const canvas = document.getElementById("canvas");
    const preview = document.getElementById("preview");
    const status = document.getElementById("status");

    // Capture from Camera
    document.getElementById("captureBtn").addEventListener("click", function () {
      const context = canvas.getContext("2d");
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      preview.src = canvas.toDataURL("image/jpeg");
      preview.style.display = "block";
      status.innerText = "‚úÖ Photo captured. Now click Upload.";
    });

    // Upload to Google Drive
    document.getElementById("uploadBtn").addEventListener("click", function () {
      canvas.toBlob(async (blob) => {
        status.innerText = "‚è≥ Uploading...";
        const formData = new FormData();
        formData.append("file", blob, `photo_${Date.now()}.jpg`);

        try {
          const res = await fetch(scriptURL, { method: "POST", body: formData });
          const data = await res.json();

          if (data.success) {
            status.innerHTML = `‚úÖ Uploaded Successfully! <a href="${data.url}" target="_blank">View File</a>`;
          } else {
            status.innerText = "‚ùå Upload failed: " + data.message;
          }
        } catch (err) {
          status.innerText = "‚ùå Upload error: " + err.message;
        }
      }, "image/jpeg");
    });
  </script>
</body>
</html>
